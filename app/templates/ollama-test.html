<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ollama 로컬 AI 데모</title>
  <!-- Axios CDN -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: 40px auto; padding: 20px; background: #f8f9fa; }
    h1 { text-align: center; color: #333; }
    .tab { overflow: hidden; border: 1px solid #ccc; background-color: #f1f1f1; border-radius: 8px 8px 0 0; }
    .tab button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 16px; }
    .tab button:hover { background-color: #ddd; }
    .tab button.active { background-color: #fff; border-bottom: 3px solid #007bff; }
    .tabcontent { display: none; padding: 30px; border: 1px solid #ccc; border-top: none; background: white; border-radius: 0 0 8px 8px; }
    textarea, input[type="text"], input[type="number"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    button.submit { background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
    button.submit:hover { background: #0056b3; }
    .response { margin-top: 20px; padding: 15px; background: #e9f7ef; border-left: 4px solid #28a745; white-space: pre-wrap; min-height: 50px; }
    .chat-box { height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background: #f8f9fa; margin-bottom: 10px; border-radius: 4px; }
    .chat-message { margin: 10px 0; padding: 10px; border-radius: 8px; }
    .user { text-align: right; background: #007bff; color: white; align-self: flex-end; }
    .ai { text-align: left; background: #e9ecef; color: #333; }
    .error { background: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
  </style>
</head>
<body>
  <h1>Ollama 로컬 AI 데모 (Axios 버전)</h1>

  <div class="tab">
    <button class="tablinks active" onclick="openTab(event, 'Chat')">챗봇</button>
    <button class="tablinks" onclick="openTab(event, 'Summarize')">텍스트 요약</button>
    <button class="tablinks" onclick="openTab(event, 'Translate')">영→한 번역</button>
    <button class="tablinks" onclick="openTab(event, 'Sentiment')">감정 분석</button>
    <button class="tablinks" onclick="openTab(event, 'Brainstorm')">아이디어 브레인스토밍</button>
    <button class="tablinks" onclick="openTab(event, 'Poem')">시 쓰기</button>
    <button class="tablinks" onclick="openTab(event, 'Recipe')">레시피 생성</button>
    <button class="tablinks" onclick="openTab(event, 'Names')">이름 제안</button>
    <button class="tablinks" onclick="openTab(event, 'Coding')">코드작성</button>
  </div>

  <!-- 1. 챗봇 -->
  <div id="Chat" class="tabcontent" style="display: block;">
    <h2>챗봇 (대화 유지)</h2>
    <div id="chatBox" class="chat-box"></div>
    <input type="text" id="chatInput" placeholder="메시지를 입력하세요..." />
    <button class="submit" onclick="sendChat()">전송</button>
  </div>

  <!-- 2. 텍스트 요약 -->
  <div id="Summarize" class="tabcontent">
    <h2>텍스트 요약기</h2>
    <textarea id="summarizeText" rows="8" placeholder="요약할 긴 텍스트를 입력하세요..."></textarea><br>
    <button class="submit" onclick="summarize()">요약하기</button>
    <div id="summarizeResult" class="response">결과가 여기에 표시됩니다.</div>
  </div>

  <!-- 3. 번역 -->
  <div id="Translate" class="tabcontent">
    <h2>영어 → 한국어 번역</h2>
    <textarea id="translateText" rows="6" placeholder="번역할 영어 문장을 입력하세요..."></textarea><br>
    <button class="submit" onclick="translateText()">번역하기</button>
    <div id="translateResult" class="response">결과가 여기에 표시됩니다.</div>
  </div>

  <!-- 4. 감정 분석 -->
  <div id="Sentiment" class="tabcontent">
    <h2>감정 분석기</h2>
    <textarea id="sentimentText" rows="5" placeholder="감정을 분석할 문장을 입력하세요..."></textarea><br>
    <button class="submit" onclick="analyzeSentiment()">분석하기</button>
    <div id="sentimentResult" class="response">결과가 여기에 표시됩니다.</div>
  </div>

  <!-- 5. 브레인스토밍 -->
  <div id="Brainstorm" class="tabcontent">
    <h2>아이디어 브레인스토밍</h2>
    <input type="text" id="brainstormTopic" placeholder="주제 (예: 집에서 할 수 있는 부업)" />
    <input type="number" id="brainstormCount" value="5" min="1" max="10" />
    <button class="submit" onclick="brainstorm()">아이디어 생성</button>
    <div id="brainstormResult" class="response">결과가 여기에 표시됩니다.</div>
  </div>

    <!-- 6. 시 쓰기 -->
  <div id="Poem" class="tabcontent">
    <h2>시 쓰기 도우미</h2>
    <input type="text" id="poemTopic" placeholder="시의 주제 (예: 가을 비, 첫사랑, 고향)" />
    <input type="text" id="poemStyle" placeholder="스타일 (예: 현대시, 시조, 자유시)" value="현대시" />
    <button class="submit" onclick="writePoem()">시 지어주기</button>
    <div id="poemResult" class="response">시가 여기에 나타납니다.</div>
  </div>

  <!-- 7. 레시피 생성기 -->
  <div id="Recipe" class="tabcontent">
    <h2>레시피 생성기</h2>
    <textarea id="recipeIngredients" rows="3" placeholder="가지고 있는 재료를 쉼표로 구분 (예: 계란, 토마토, 양파, 치즈)"></textarea>
    <div style="margin: 10px 0;">
      <label>인분: <input type="number" id="recipeServings" value="2" min="1" max="10" style="width:80px;" /></label>
      <label style="margin-left:20px;">난이도:
        <select id="recipeDifficulty">
          <option value="쉬움">쉬움</option>
          <option value="보통">보통</option>
          <option value="어려움">어려움</option>
        </select>
      </label>
    </div>
    <button class="submit" onclick="generateRecipe()">레시피 만들어줘</button>
    <div id="recipeResult" class="response">레시피가 여기에 나타납니다.</div>
  </div>

  <!-- 8. 이름 제안 -->
  <div id="Names" class="tabcontent">
    <h2>이름 지어주기 도우미</h2>
    <select id="nameCategory">
      <option value="아기">아기 이름</option>
      <option value="강아지">강아지 이름</option>
      <option value="고양이">고양이 이름</option>
      <option value="프로젝트">프로젝트 이름</option>
      <option value="카페">카페 이름</option>
      <option value="브랜드">브랜드 이름</option>
    </select>
    <select id="nameGender" style="margin-left:10px;">
      <option value="중성">중성</option>
      <option value="남자">남자</option>
      <option value="여자">여자</option>
    </select>
    <input type="text" id="nameVibe" placeholder="느낌 (예: 귀여운, 세련된, 따뜻한) - 선택" style="margin-top:10px;" />
    <div style="margin:10px 0;">
      <label>제안 개수: <input type="number" id="nameCount" value="5" min="3" max="10" style="width:80px;" /></label>
    </div>
    <button class="submit" onclick="suggestNames()">이름 제안해줘</button>
    <div id="namesResult" class="response">이름들이 여기에 나타납니다.</div>
  </div>

  <!-- 9. 코딩 -->
  <div id="Coding" class="tabcontent">
    <h2>코딩을 도와줘 </h2>
    <select id="codingLanguage">
      <option value="C++">C++</option>
      <option value="파이선">파이선</option>
      <option value="자바">자바</option>
    </select>
    <select id="codingDiffer" style="margin-left:20px;">
      <option value="쉽게">쉽게</option>
      <option value="보통으로">보통으로</option>
      <option value="복잡하게">복잡한</option>
    </select>
    <input type="text" id="codingText" placeholder="TCP 네트워크를 스래드를 이용하여 비동기 처리할 수 있는" style="margin-top:10px;" />
    <div style="margin:10px 0;">
      <label>제안 줄수: <input type="number" id="codingCount" value="100" min="100" max="200" style="width:80px;" /></label>
    </div>
    <button class="submit" onclick="codingMake()">코드를 작성해줘</button>
    <div id="codingResult" class="response">코드는 여기에 나타납니다</div>
  </div>

  <script>
    const API_URL = "http://127.0.0.1:8000";

    function openTab(evt, tabName) {
      const tabcontent = document.getElementsByClassName("tabcontent");
      for (let i = 0; i < tabcontent.length; i++) tabcontent[i].style.display = "none";
      const tablinks = document.getElementsByClassName("tablinks");
      for (let i = 0; i < tablinks.length; i++) tablinks[i].className = tablinks[i].className.replace(" active", "");
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }

    // 공통 에러 처리 함수
    function handleError(err, resultElementId) {
      console.error(err);
      const msg = err.response?.data?.detail || err.message || "서버 연결 실패";
      document.getElementById(resultElementId).innerHTML = `<div class="error">오류: ${msg}</div>`;
    }

    // 1. 챗봇
    function sendChat() {


    }

    document.getElementById("chatInput").addEventListener("keypress", e => {
      if (e.key === "Enter") sendChat();
    });

    // 2. 요약
    function summarize() {
        // 입력 값 가져오기 summarizeText
        text = document.getElementById('summarizeText').value
        // 없으면 함수 중단
        if(!text) return;
        // 결과 너ㅓㅎ는 곳에 처리중 ... 넣어 두자
        document.getElementById('summarizeResult').innerHTML = '처리중 ... '
        // axios 요청해서 결과 받아와야함
        axios.post('/summarize', {text})
            .then( res => {
                console.log(res.data.summary)
                // 받아온 결과를 summrizeResult 에 넣어야 함
                document.getElementById('summarizeResult').innerText = res.data.summary
            })
    }

    // 3. 번역
    function translateText() {
       text = document.getElementById("translateText").value.trim();
       // 없으면 함수 중단
       if(!text) return;
       // 결과 처리중 ... 넣어 두자
       document.getElementById('translateResult').innerHTML = '처리중 ... '
       // axios 요청해서 결과 받아와야함
        axios.post('/translate', {text})
            .then( res => {
                console.log(res.data.translate)
                // 받아온 결과를 translateResult 에 넣어야 함
                document.getElementById('translateResult').innerText = res.data.translate
            })
    }

    // 4. 감정 분석
    function analyzeSentiment() {
        text = document.getElementById("sentimentText").value.trim();
        // 없으면 함수 중단
        if(!text) return;
        // 결과 처리중 ... 넣어 두자
        document.getElementById('sentimentResult').innerHTML = '처리중 ... '
        // axios 요청해서 결과 받아와야함
        axios.post('/sentiment', {text})
            .then( res => {
                console.log(res.data.sentiment)
                // 받아온 결과를 translateResult 에 넣어야 함
                document.getElementById('sentimentResult').innerText = res.data.sentiment
            })

    }

    // 5. 브레인스토밍
    function brainstorm() {
        topic = document.getElementById("brainstormTopic").value.trim();
        count = document.getElementById("brainstormCount").value;
        // 없으면 함수 중단
        if(!topic) return;
        // 결과 처리중 ... 넣어 두자
        document.getElementById('brainstormResult').innerHTML = '처리중 ... '
        // axios 요청해서 결과 받아와야함
        axios.post('/brainstorm', {topic, count})
            .then( res => {
                console.log(res.data.brainstorm)
                // 받아온 결과를 translateResult 에 넣어야 함
                document.getElementById('brainstormResult').innerText = res.data.brainstorm
            })
    }

          // 6. 시 쓰기
    function writePoem() {
        topic = document.getElementById("poemTopic").value.trim();
        style = document.getElementById("poemStyle").value.trim();
        // 없으면 함수 중단
        if(!topic) return;
        // 결과 처리중 ... 넣어 두자
        document.getElementById('poemResult').innerHTML = '처리중 ... '
        // axios 요청해서 결과 받아와야함
        axios.post('/poem', {topic, style})
            .then( res => {
                console.log(res.data.poem)
                // 받아온 결과를 translateResult 에 넣어야 함
                document.getElementById('poemResult').innerText = res.data.poem
            })
    }

    // 7. 레시피 생성
    function generateRecipe() {
        ingredients = document.getElementById("recipeIngredients").value;
        servings = document.getElementById("recipeServings").value;
        difficulty = document.getElementById("recipeDifficulty").value;
        // 없으면 함수 중단
        if(!ingredients) return;
        // 결과 처리중 ... 넣어 두자
        document.getElementById('recipeResult').innerHTML = '처리중 ... '
        // axios 요청해서 결과 받아와야함
        axios.post('/recipe', {ingredients, servings, difficulty})
            .then( res => {
                console.log(res.data.recipe)
                // 받아온 결과를 translateResult 에 넣어야 함
                document.getElementById('recipeResult').innerText = res.data.recipe
            })
    }

    // 8. 이름 제안
    function suggestNames() {
        // 4개의 값을 가져온다.
        category = document.getElementById("nameCategory").value
        gender = document.getElementById("nameGender").value
        vibe = document.getElementById("nameVibe").value
        count = document.getElementById("nameCount").value

        // result에 부분에 "이름 제안  중 .. " 넣자
        document.getElementById("namesResult").innerHTML = "이름 제안 중 ... "

        // axios로 4개의 값을 json으로 주면서 요청
        axios.post('/names', {category, gender, vibe, count})
            .then( res => {
                console.log(res.data.names)
                // 받아온 결과를 namesResult 에 넣어야 함
                document.getElementById('namesResult').innerText = res.data.names
            })
    }

    // 9. 코딩작성
    function codingMake() {
        // 4개의 값을 가져온다.
        language = document.getElementById("codingLanguage").value
        differ = document.getElementById("codingDiffer").value
        text = document.getElementById("codingText").value
        count = document.getElementById("codingCount").value

        // result에 부분에 "이름 제안  중 .. " 넣자
        document.getElementById("codingResult").innerHTML = "코딩작성 중 ... "

        // axios로 4개의 값을 json으로 주면서 요청
        axios.post('/coding', {language, differ, text, count})
            .then( res => {
                console.log(res.data.coding)
                // 받아온 결과를 namesResult 에 넣어야 함
                document.getElementById('codingResult').innerText = res.data.coding
            })
    }

  </script>
</body>
</html>